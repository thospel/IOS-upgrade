[Define Variable=newline,Single]
${}
${}

[Define]
overwrite = ${caller.overwrite}
# Press enter 3 times to confirm user/pass/path
confirm = ${newline}${newline}${newline}

[If Not,FromVariable=overwrite]
0
    # Need to press enter one more time to confirm overwrite
    [Assign]
    confirm = ${confirm}${newline}
[EndIf]

[Commands Single, DefineVariable=fileserver_result]
copy ${global.fileserver_url}${caller.file} ${caller.filesystem}:
# Press enter 3 times to confirm user/pass/path
${confirm}

[If Regex,FromVariable=fileserver_result]
(?<transfer_line>(?<size>\d+) bytes copied.*)
    [If Regex,FromVariable=transfer_line,Anchor=Substring]
    \(\s*(?<speed>\d+)\s+bytes/sec\)$
        [Return]
        size  = ${size}
        speed = ${speed}
    [Else]
        [Error]
        Cannot parse file transfer message '${transfer_line}'
    [Endif]
[Else]
    [Error]
    Cannot find "bytes copied" in copy output
[EndIf]
